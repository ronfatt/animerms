(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7253:(e,t,r)=>{Promise.resolve().then(r.bind(r,7322))},7322:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var s=r(5155),i=r(2115);let a=[{key:"director_plan",label:"1) Generate Director Plan"},{key:"script_45s",label:"2) Generate 45s Script"},{key:"panel_prompts",label:"3) Generate Panel Prompts"},{key:"gemini_storyboard",label:"4) Generate Gemini Storyboard"},{key:"motion_plan",label:"5) Generate Motion Plan"},{key:"audio_plan",label:"6) Generate Audio Plan"}];function n(){let[e,t]=(0,i.useState)(""),[r,n]=(0,i.useState)("Pahlawan Ombak"),[l,o]=(0,i.useState)(10),[d,c]=(0,i.useState)("9:16"),[u,p]=(0,i.useState)("BM_SABAH"),[h,g]=(0,i.useState)("LOCAL_X_ANIME"),[b,m]=(0,i.useState)(1),[y,x]=(0,i.useState)(""),[j,f]=(0,i.useState)(9),[S,v]=(0,i.useState)(1),[w,I]=(0,i.useState)(3),[k,_]=(0,i.useState)(["script_45s","panel_prompts","gemini_storyboard"]),[E,N]=(0,i.useState)({director_plan:{status:"idle",progress:0},script_45s:{status:"idle",progress:0},panel_prompts:{status:"idle",progress:0},gemini_storyboard:{status:"idle",progress:0},motion_plan:{status:"idle",progress:0},audio_plan:{status:"idle",progress:0}}),[C,P]=(0,i.useState)([]),[B,A]=(0,i.useState)("Ready"),T=(0,i.useMemo)(()=>new Set(k),[k]);async function R(e,t){let r=await fetch(e,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)}),s=await r.json();if(!r.ok)throw Error(s.error||"HTTP ".concat(r.status));return s}async function M(e){let t=await fetch(e),r=await t.json();if(!t.ok)throw Error(r.error||"HTTP ".concat(t.status));return r}async function G(){try{A("Creating series...");let e=await R("/api/series",{title:r,totalEpisodes:l,ratio:d,languageMode:u,stylePreset:h});t(e.seriesId),A("Series created: ".concat(e.seriesId))}catch(e){A(String(e))}}async function H(){if(!e)throw Error("Please create/select series first");let t=await R("/api/episodes",{seriesId:e,epNumber:b,title:"Episode ".concat(String(b).padStart(2,"0")),outline:{panelCount:j}});return x(t.episodeId),t.episodeId}async function O(e,t){let r=setInterval(async()=>{try{let s=await M("/api/jobs/".concat(t));N(r=>({...r,[e]:{jobId:t,status:s.status,progress:s.progress,error:s.error,logs:s.logs}})),["done","failed"].includes(s.status)&&clearInterval(r)}catch(e){clearInterval(r)}},1500)}async function D(t){try{A("Queueing ".concat(t,"..."));let r=y||await H(),s=await R("/api/jobs",{seriesId:e,episodeId:r,step:t,panelCount:j});N(e=>({...e,[t]:{jobId:s.jobId,status:"queued",progress:0}})),O(t,s.jobId),A("Queued ".concat(t,": ").concat(s.jobId))}catch(e){A(String(e))}}async function L(){try{if(!e)throw Error("Please create/select series first");A("Queueing batch...");let t=await R("/api/series/".concat(e,"/batch"),{fromEp:S,toEp:w,steps:k,panelCount:j});A("Batch queued: EP".concat(t.fromEp,"-EP").concat(t.toEp)),await U()}catch(e){A(String(e))}}async function U(){try{if(!e)return;let t=await M("/api/series/".concat(e,"/episodes"));P(t.episodes||[])}catch(e){A(String(e))}}return(0,i.useEffect)(()=>{try{let e=localStorage.getItem("comic_wizard_state_v1");if(e){let r=JSON.parse(e);r.seriesId&&t(r.seriesId),r.title&&n(r.title),Number.isInteger(r.totalEpisodes)&&o(Number(r.totalEpisodes)),r.ratio&&c(r.ratio),r.languageMode&&p(r.languageMode),r.stylePreset&&g(r.stylePreset),Number.isInteger(r.epNumber)&&m(Number(r.epNumber)),r.episodeId&&x(r.episodeId),Number.isInteger(r.panelCount)&&f(Number(r.panelCount)),Number.isInteger(r.batchFrom)&&v(Number(r.batchFrom)),Number.isInteger(r.batchTo)&&I(Number(r.batchTo)),Array.isArray(r.batchSteps)&&r.batchSteps.length>0&&_(r.batchSteps)}}catch(e){}let e=new URLSearchParams(window.location.search),r=e.get("seriesId"),s=e.get("episodeId"),i=e.get("ep");r&&t(r),s&&x(s),i&&Number.isInteger(Number(i))&&m(Number(i))},[]),(0,i.useEffect)(()=>{localStorage.setItem("comic_wizard_state_v1",JSON.stringify({seriesId:e,title:r,totalEpisodes:l,ratio:d,languageMode:u,stylePreset:h,epNumber:b,episodeId:y,panelCount:j,batchFrom:S,batchTo:w,batchSteps:k}))},[e,r,l,d,u,h,b,y,j,S,w,k]),(0,i.useEffect)(()=>{e&&U()},[e]),(0,s.jsxs)("main",{style:{padding:20,fontFamily:"ui-sans-serif, system-ui",background:"#f5f7fb",minHeight:"100vh"},children:[(0,s.jsx)("h1",{children:"Comic Pipeline MVP - Step Wizard"}),(0,s.jsx)("p",{children:B}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[(0,s.jsxs)("section",{style:{background:"#fff",padding:12,borderRadius:12},children:[(0,s.jsx)("h2",{children:"Series Input"}),(0,s.jsx)("label",{children:"Title"}),(0,s.jsx)("input",{value:r,onChange:e=>n(e.target.value),style:{width:"100%",marginBottom:8}}),(0,s.jsx)("label",{children:"Total Episodes (max 30)"}),(0,s.jsx)("input",{type:"number",min:1,max:30,value:l,onChange:e=>o(Number(e.target.value)),style:{width:"100%",marginBottom:8}}),(0,s.jsx)("label",{children:"Ratio"}),(0,s.jsxs)("select",{value:d,onChange:e=>c(e.target.value),style:{width:"100%",marginBottom:8},children:[(0,s.jsx)("option",{value:"9:16",children:"9:16"}),(0,s.jsx)("option",{value:"16:9",children:"16:9"})]}),(0,s.jsx)("label",{children:"Language Mode"}),(0,s.jsxs)("select",{value:u,onChange:e=>p(e.target.value),style:{width:"100%",marginBottom:8},children:[(0,s.jsx)("option",{value:"BM_SABAH",children:"BM_SABAH"}),(0,s.jsx)("option",{value:"HYBRID",children:"HYBRID"}),(0,s.jsx)("option",{value:"SULUK",children:"SULUK"}),(0,s.jsx)("option",{value:"BAJAU",children:"BAJAU"})]}),(0,s.jsx)("label",{children:"Style Preset"}),(0,s.jsx)("input",{value:h,onChange:e=>g(e.target.value),style:{width:"100%",marginBottom:8}}),(0,s.jsx)("button",{onClick:G,children:"Create Series"}),(0,s.jsxs)("div",{style:{marginTop:8},children:["Series ID: ",e||"-"]})]}),(0,s.jsxs)("section",{style:{background:"#fff",padding:12,borderRadius:12},children:[(0,s.jsx)("h2",{children:"Episode Builder"}),(0,s.jsx)("label",{children:"Episode Number"}),(0,s.jsx)("input",{type:"number",min:1,value:b,onChange:e=>m(Number(e.target.value)),style:{width:"100%",marginBottom:8}}),(0,s.jsx)("label",{children:"Panel Count (9 or 12)"}),(0,s.jsxs)("select",{value:j,onChange:e=>f(Number(e.target.value)),style:{width:"100%",marginBottom:8},children:[(0,s.jsx)("option",{value:9,children:"9"}),(0,s.jsx)("option",{value:12,children:"12"})]}),(0,s.jsx)("button",{onClick:async()=>x(await H()),children:"Prepare Episode"}),(0,s.jsxs)("div",{style:{marginTop:8},children:["Episode ID: ",y||"-"]}),(0,s.jsx)("div",{style:{marginTop:12},children:a.map(e=>{let t=E[e.key];return(0,s.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:8,padding:8,marginBottom:8},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[(0,s.jsx)("strong",{children:e.label}),(0,s.jsx)("button",{onClick:()=>D(e.key),children:"Run / Retry"})]}),(0,s.jsxs)("div",{children:["Status: ",t.status," | Progress: ",t.progress,"% | Job: ",t.jobId||"-"]}),t.error?(0,s.jsxs)("div",{style:{color:"#b91c1c"},children:["Error: ",t.error]}):null]},e.key)})})]})]}),(0,s.jsxs)("section",{style:{background:"#fff",padding:12,borderRadius:12,marginTop:16},children:[(0,s.jsx)("h2",{children:"Batch Generate"}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"120px 120px 1fr auto",gap:8,alignItems:"center"},children:[(0,s.jsx)("input",{type:"number",min:1,value:S,onChange:e=>v(Number(e.target.value))}),(0,s.jsx)("input",{type:"number",min:1,value:w,onChange:e=>I(Number(e.target.value))}),(0,s.jsx)("div",{children:a.map(e=>(0,s.jsxs)("label",{style:{marginRight:12},children:[(0,s.jsx)("input",{type:"checkbox",checked:T.has(e.key),onChange:()=>{var t;return t=e.key,void _(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])}})," ",e.key]},e.key))}),(0,s.jsx)("button",{onClick:L,children:"Run Batch"})]})]}),(0,s.jsxs)("section",{style:{background:"#fff",padding:12,borderRadius:12,marginTop:16},children:[(0,s.jsx)("h2",{children:"Episode List"}),(0,s.jsx)("button",{onClick:U,children:"Refresh Episodes"}),(0,s.jsxs)("table",{style:{width:"100%",marginTop:8,borderCollapse:"collapse"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{style:{textAlign:"left"},children:"Episode"}),(0,s.jsx)("th",{style:{textAlign:"left"},children:"Status"}),(0,s.jsx)("th",{style:{textAlign:"left"},children:"Title"}),(0,s.jsx)("th",{style:{textAlign:"left"},children:"ID"}),(0,s.jsx)("th",{style:{textAlign:"left"},children:"Detail"})]})}),(0,s.jsx)("tbody",{children:C.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsxs)("td",{children:["EP",String(e.epNumber).padStart(2,"0")]}),(0,s.jsx)("td",{children:e.status}),(0,s.jsx)("td",{children:e.title}),(0,s.jsx)("td",{children:e.id}),(0,s.jsx)("td",{children:(0,s.jsx)("a",{href:"/episodes/".concat(e.id),target:"_blank",rel:"noreferrer",children:"View"})})]},e.id))})]})]})]})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=7253)),_N_E=e.O()}]);